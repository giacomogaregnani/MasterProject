\documentclass{scrartcl}

\input{Preamble}

\begin{document}
	
\section*{Random time stepping}

Let us consider $f\colon\R^d\to\R^d$ and the ODE 
\begin{equation}\label{eq:ODE}
	y' = f(y), \quad y(0) = y_0 \in \R^d.
\end{equation}
We can write the solution $y(t)$ in terms of the flow of the ODE, i.e., the function $\phi\colon\R\times\R^d\to\R^d$ such that 
\begin{equation}
	y(t) = \phi(t, y_0).
\end{equation}
Let us consider a Runge-Kutta method for \eqref{eq:ODE}. Given a time step $h$, we can write the numerical solution at $y_n$ approximation of $y(t_n)$, with $t_n = nh$ in terms of the numerical flow $\Psi\colon\R\times\R^d\to\R^d$, which is uniquely determined by the coefficients of the method, as
\begin{equation}
	y_n = \Psi(h, y_{n-1}).
\end{equation}
If the ODE is chaotic, integrating the equation with different time steps leads to different numerical solutions. In order to describe the uncertainty of the numerical solution, we choose at each time $t_n$ the time step as the realization of a random variable $H_n$. Therefore, the numerical solution is given by a discrete stochastic process $\{Y_n\}_{n\geq 0}$ such that
\begin{equation}\label{eq:numHSto}
	Y_n = \Psi(H_n, Y_{n-1}).
\end{equation}
This probabilistic numerical method shares the basic idea with \cite{CGS16}. 

\section{Strong order analysis}

We wish to deduce a result of strong convergence for the numerical method \eqref{eq:numHSto}. 
\begin{definition} The numerical method \eqref{eq:numHSto} has strong local order $r$ for \eqref{eq:ODE} if there exists a constant $C > 0$ such that
	\begin{equation}
	\E\abs{Y_1 - y(h)} \leq Ch^{r+1}.
	\end{equation}
\end{definition} 
\noindent In the following we will establish the assumptions needed to prove a result of strong convergence. First of all, we state a regularity assumption on the exact flow $\phi(t,y)$.
\begin{assumption} The exact flow $\phi(t,y)$ of \eqref{eq:ODE} is smooth in both its variables and there exists a constant $L > 0$ such that 
	\begin{equation}
		\norm{\phi(t, y) - \phi(s, y)} \leq L|t - s|, \forall y \in \R^d
 	\end{equation}
\end{assumption}
\noindent The following assumption on the random variables $\{H_n\}_{n\geq 0}$ is needed for strong convergence.
\begin{assumption}\label{as:hStrong} The i.i.d. random variables $H_n$ satisfy for all $n = 1, 2, \ldots$
	\begin{enumerate}
		\item $H_n > 0$ a.s.,
		\item there exists $h > 0$ such that $\E[H_n] = h$ and $\E[H_n^i] \leq Ch^i$ for all $i = 1, 2, \ldots$,
		\item there exists $p \geq 1$ such that the random variables $Z_n \defeq H_n - h$ satisfy
		\begin{equation}
		\E\abs{Z_n}^2 = Ch^{2p}.
		\end{equation}
	\end{enumerate}
\end{assumption}
\begin{remark} The second of the assumptions above implies that
	\begin{equation}
	\begin{aligned}
	\E|H_n|^2 &= \E|Z_n|^2 - \E[h^2 - 2hH_n]
	&\leq Ch^{2p} + h^2
	\end{aligned}
	\end{equation}	
\end{remark}
\begin{example}\label{ex:uniformH} An example of random variables $H_n$ satisfying the properties above is given by
	\begin{equation}
		H_n \iid \mathcal{U}(h-h^p, h+h^p), \quad 0 < h \leq 1, \quad p > 1
	\end{equation}
	Let us verify all the assumptions above for this choice of the time steps
	\begin{enumerate}
		\item $H_n > 0$ a.s. trivially since $h \leq 1$,
		\item $\E[H_n] = h$ since 
		\begin{equation}
			\E[H_n] = \frac{1}{2}(h + h^p + h - h^p) = h.
		\end{equation}
		For higher order moments, let us recall that the moment generating function $\mu_{m}(U)$ of a random variable $U \sim \mathcal{U}(a,b)$ is given by
		\begin{equation}
			\mu_m(U) =  \frac{b^{m+1} - a^{m+1}}{m(b-a)}.
		\end{equation}
		Hence, for the variables $H_n$ we have
		\begin{equation}
		\begin{aligned}
			\mu_{(m-1)}(H_n) &= \frac{(h + h^p)^{m} - (h - h^p)^{m}}{2mh^p}\\
			&= \frac{\sum_{k=0}^m \alpha_k h^{m-k}(h^{pk} - (-h^p)^k)}{2mh^p}, \quad \alpha_k = \binom{m}{k},
		\end{aligned}
		\end{equation}
		where we used the Newton's binomial formula. Then, let us remark that for all even values $k$ the elements of the sum above are zero. Therefore, for $m$ even, we have
		\begin{equation}
		\begin{aligned}
			\mu_{(m-1)}(H_n) &= \frac{\sum_{k=0}^{m/2 - 1} \alpha_{2k + 1} h^{m-(2k+1)}2h^{p(2k+1)}}{2mh^p}\\
			&= \frac{h^{m-1}\sum_{k=0}^{m/2 - 1} \alpha_{2k + 1} h^{2k(p-1)}}{m},
		\end{aligned}
		\end{equation}
		while for $m$ odd, we have
		\begin{equation}
		\begin{aligned}
			\mu_{(m-1)}(H_n) &= \frac{\sum_{k=0}^{(m-1)/2} \alpha_{2k + 1} h^{m-(2k+1)}2h^{p(2k+1)}}{2mh^p}\\
			&= \frac{h^{m-1}\sum_{k=0}^{(m-1)/2} \alpha_{2k + 1} h^{2k(p-1)}}{m}.
		\end{aligned}
		\end{equation}
		In both cases, since $h < 1$ and $p > 1$, we have that $h^{2k(p-1)} < 1$, therefore there exists a positive constant $C$ such that
		\begin{equation}
			\E[H_n^m] \leq Ch^m, \quad \forall m \geq 1.
		\end{equation}
		\item The random variables $Z_n = H_n - h$ are $Z_n \sim \mathcal{U}(-h^p, h^p)$. Therefore
		\begin{equation}
			\E[Z_n^2] = \frac{4h^{2p}}{12} = \frac{1}{3}h^{2p}.
		\end{equation}
	\end{enumerate}
\end{example}
\noindent The following assumption on the numerical flow is needed.
\begin{assumption}\label{as:PsiStrong} The Runge-Kutta method has local order $q$, i.e., there exists a constant $C > 0$ such that
	\begin{equation}
	\sup_{y\in\R^d} \abs{\Psi(h, y) - \phi(h, y)} \leq Ch^{q+1}.
	\end{equation}
	Moreover, the function $t \mapsto \Psi(t, y)$ is of class $\mathcal{C}^2(\R_+)$ and there exists a constant $M > 0$ such that 
	\begin{equation}
	\abs{\pdv[i]{\Psi(0, y)}{t}} \leq M, \quad i = 1, 2, \: \forall y \in \R^d.
	\end{equation} 
\end{assumption}
\begin{remark} Let us remark that the first condition above implies for $f$ sufficiently smooth that
	\begin{equation}
		\sup_{n = 1, 2, \ldots} \abs{\Psi(h, y_n) - \phi(nh, y_0)} \leq Ch^{q},
	\end{equation}
	i.e., the Runge-Kutta method has global order $q$.
\end{remark}
\noindent The strong convergence of \eqref{eq:numHSto} can now be proved. 
\begin{theorem}[Strong local order] Under Assumptions \ref{as:hStrong} and \ref{as:PsiStrong} the numerical solution $Y_1$ given by one step of \eqref{eq:numHSto} satisfies 
	\begin{equation}
	\E\abs{Y_1 - y(h)} \leq C h^{\min\{q + 1, p\}},
	\end{equation}
	where $C$ is a real positive constant independent of $h$.
\end{theorem}
\begin{proof} We apply the triangular inequality and get
	\begin{equation}\label{eq:firstStepStrong}
	\begin{aligned}
	\E\abs{\Psi(H, y_0) - \phi(h, y_0)} &\leq \E\abs{\Psi(H, y_0) - \Psi(h, y_0)} + \E\abs{\Psi(h, y_0) - \phi(h, y_0)} \\
	&\leq \E\abs{\Psi(H, y_0) - \Psi(h, y_0)} + C_1h^{q+1},
	\end{aligned}
	\end{equation}
	where we exploited Assumption \ref{as:PsiStrong}. Developing the first term in Taylor series and applying the triangular inequality we have
	\begin{equation}
	\begin{aligned}
	\E\abs{\Psi(H, y_0) - \Psi(h, y_0)} &= \E\big|\Psi(0, y_0) + H\pdv{\Psi}{t} (0, y_0) + R(H) \\
	&\quad - \Psi(0, y_0) - h\pdv{\Psi}{t} (0, y_0) - R(h) \big| \\
	&\leq \E\big|(H - h)\pdv{\Psi}{t} (0, y_0)\big| + \E|R(H) - R(h)|.
	\end{aligned}
	\end{equation}
	Let us consider the reminder terms in integral form
	\begin{equation}
	\begin{aligned}
	\E|R(H) - R(h)| &= \E\Big| \int_{0}^{H}\pdv[2]{\Psi}{t} (s, y_0)(H-s)\dd s - \int_{0}^{h}\pdv[2]{\Psi}{t} (s, y_0)(h-s)\dd s \Big|\\
	&= \E\Big| \int_{0}^{H}\pdv[2]{\Psi}{t} (s, y_0)(H-s)\dd s - \int_{0}^{H}\pdv[2]{\Psi}{t} (s, y_0)(h-s)\dd s \\
	&\quad - \int_{H}^{h}\pdv[2]{\Psi}{t} (s, y_0)(h-s)\dd s \Big|\\
	&= \E\Big| \int_{0}^{H}\pdv[2]{\Psi}{t} (s, y_0)(H-h)\dd s - \int_{H}^{h}\pdv[2]{\Psi}{t} (s, y_0)(h-s)\dd s\Big|.
	\end{aligned}
	\end{equation}
	Applying the triangular inequality and thanks to Assumption \ref{as:PsiStrong} we can therefore bound the difference with
	\begin{equation}
	\begin{aligned}
	\E|R(H) - R(h)| &\leq \E\Big|\int_{0}^{H}\pdv[2]{\Psi}{t} (s, y_0)(H-h)\dd s \Big| + \E\Big|  \int_{H}^{h}\pdv[2]{\Psi}{t} (s, y_0)(h-s)\dd s \Big| \\
	&\leq M \E|H(H-h)| + \frac{1}{2}M\E|H-h|^2 \\
	&\leq M (\E|H|^2)^{1/2}(\E|H-h|^2)^{1/2} + \frac{1}{2}Mh^{2p}\\
	&\leq M(Ch^{2p} + h^2)^{1/2}h^p + \frac{1}{2}Mh^{2p}\\
	&\leq M h^{p+1} + \frac{1}{2}h^{2p},
	\end{aligned} 
	\end{equation}
	where we exploited Assumption \ref{as:hStrong}. Hence, we find 
	\begin{equation}
	\begin{aligned}
	\E\abs{\Psi(H, y_0) - \Psi(h, y_0)} &\leq \E|(H-h)\pdv{\Psi}{t} (0, y_0)| + M h^{p+1} + \frac{1}{2}h^{2p} \\
	&\leq M\E|H - h| +  M h^{p+1} + \frac{1}{2}h^{2p}\\
	&\leq M(\E|H-h|^2)^{1/2} +  M h^{p+1} + \frac{1}{2}h^{2p} \\
	&\leq Mh^p + M h^{p+1} + \frac{1}{2}h^{2p} \\
	&\leq C_2 h^p
	\end{aligned}
	\end{equation}
	where we applied Assumption \ref{as:hStrong} and Jensen's inequality. Substituting in \eqref{eq:firstStepStrong}, we get
	\begin{equation}
	\E\abs{Y_1 - y(h)} \leq C_1h^{q+1} + C_2 h^{p} \leq Ch^{\min\{q+1, p\}},
	\end{equation}
	which is the desired result.
\end{proof}
\noindent A result on strong global convergence is needed when integrating \eqref{eq:ODE} from time $t_0 = 0$ to a final time $T$.
\begin{theorem}[Strong global order] Under Assumptions \ref{as:hStrong} and \ref{as:PsiStrong} the numerical solution $Y_n$ given by \eqref{eq:numHSto} satisfies 
	\begin{equation}\label{eq:StrongGlobalClaim}
	\sup_{n=1,2, \ldots} \E\abs{Y_n - y(nh)} \leq C h^{\min\{q, p-1/2\}},
	\end{equation}
	where $C$ is a real positive constant independent of $h$.
\end{theorem}
\begin{proof} Let us define the times $t_n = nh$, for $n = 0, 1, \ldots$, and the random variables $\{T_n\}_{n\geq 0}$ as
	\begin{equation}
		T_n \defeq \sum_{i=1}^{n} H_n.
	\end{equation}
	Thanks to Assumption \ref{as:hStrong}, the expectation of $T_n$ satisfies
	\begin{equation}
		\E[T_n] = \sum_{i=1}^{n}\E[H_n] = t_n,
	\end{equation} 
	and the second moment of the scaled variables satisfy
	\begin{equation}
	\begin{aligned}
		\E|T_n - t_n|^2 &= \E\Big|\sum_{i=1}^{n}(H_n - h)\Big|^2 \\
		&\leq \sum_{i = 1}^{n}(\E|H_n - h|^2) \\
		&\leq Cnh^{2p} \\
		&\leq Ch^{2p-1}, 
	\end{aligned} 
	\end{equation}
	where we assumed $n = \OO(h^{-1})$ and we exploited Jensen's inequality. Therefore, we can bound the error at the $n+1$-th iteration as
	\begin{equation}
	\begin{aligned}
		\E|Y_{n+1} - y(t_{n+1})| &= \E|\Psi(H_n, Y_n) - \phi(t_{n+1},y_0)|\\
		&\leq \E|\Psi(H_n, Y_n) - \phi(T_{n+1}, y_0)| + \E|\phi(T_{n+1}, y_0) - \phi(t_{n+1},y_0)| \\
		&\leq C\E|H^q|+ L\E|T_{n+1} - t_{n+1}|\\
		&\leq Ch^q + L(\E|T_{n+1} - t_{n+1}|^2)^{1/2}\\
		&\leq Ch^q + Lh^{p - 1/2}\\
		&\leq Ch^{\min\{q, p-1/2\}},
	\end{aligned}
	\end{equation}
	which is the desired result.
\end{proof}

\section{Numerical experiment - chaotic ODE}

\begin{figure}[t]
	\centering
	\resizebox{0.6\linewidth}{!}{\input{plots/ScatterLorenz.tikz}}
	\caption{Scatter plot of 1000 realizations of the numerical solution at final time $T=40$.}
	\label{fig:ScatterLorenz}
\end{figure}

We consider the Lorenz system 
\begin{equation}\label{eq:Lorenz}
\begin{aligned}
x' &= \sigma(y - x), \quad &&x(0) = -10,\\
y' &= x(\rho - z) - y, \quad &&y(0) = -1,\\
z' &= xy - \beta z, \quad &&z(0) = 40.
\end{aligned}
\end{equation}
with $\sigma = 10$, $\rho = 28$, $\beta = 8/3$, so that the system has chaotic behavior. We solve numerically the equation with \eqref{eq:numHSto}, where we choose $\Psi$ to be the explicit midpoint method and the time steps $H_n$ to be distributed as in Example \ref{ex:uniformH} with $p = 2.5$, so that the strong global order is 2, and $h = 10^{-2}$. We wish to approximate the solution at time $T = 40$, so we consider $n = 0, 1, \ldots, N$, where $N = T / h = 4000$, so that $\E[T_N] = T$. We consider $M = 1000$ realizations of the numerical solution. A scatter plot of the values of the solution at final time (Figure \ref{fig:ScatterLorenz}), shows that the numerical solution captures the typical behavior of the Lorenz system. Twenty realizations of the numerical solution are displayed in Figure \ref{fig:SolutionLorenz}, showing results which are in accord with the numerical method presented in \cite{CGS16}.


\begin{figure}[t]
	\centering
	\resizebox{1.0\linewidth}{!}{\input{plots/PlotLorenz.tikz}}
	\caption{Realizations of the first component solution up to time $T=40$. The chaotic behavior of the equation is captured by the numerical method.}
	\label{fig:SolutionLorenz}
\end{figure}

\bibliographystyle{siam}
\bibliography{anmc}

\end{document}
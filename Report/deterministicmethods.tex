\subsection{Deterministic methods}

The deterministic numerical methods we consider in this work belong to the class of Runge-Kutta methods. The properties of Runge-Kutta methods are extensively treated, for example, in \cite{HLW02, HaW96}. In the following, we recall the definition of the method as well as some basic properties. \\
Let us give the definition of this class of numerical methods.
\begin{definition}\label{def:RK} (\textbf{Check with course notes AA}) Let us consider an ODE of the form \eqref{eq:ODE}, an integer number of stages $s$ and scalars $b_i$, for $i = 1, \ldots, s$, and $a_{ij}$, for $i, j = 1, \ldots, s$. Moreover, let us consider a time step $h > 0$ and a time discretization $t_k = kh$ for $k = 0, \ldots, N$, with $t_N = T$. Then, an $s$-stage Runge-Kutta method is defined as
\begin{equation}
\begin{aligned}
	U_0 &= u_0, \\
	K_i &= f(U_k + h\sksum_{j=1}^s a_{ij}K_j), && i = 1, \ldots, s, \\
	U_{k+1} &= U_k + h \sksum_{i=1}^s b_i K_i, && k = 0, \ldots, N-1,
\end{aligned}
\end{equation}
where $K_i$ are vectors of $\R^d$ for all $i = 1, \ldots, s$ and are called the stages of the method.
\end{definition}
\begin{remark} Runge-Kutta methods are usually defined for non-autonomous systems taking into account evaluation points $c_i$ for $i = 1, \ldots, s$. In our case, we focus on autonomous systems of the form \eqref{eq:ODE}, therefore we do not include the evaluation points $c_i$ in the definition of Runge-Kutta methods. Let us remark that for the consistency of the numerical method it is required that $c_i = \sksum_{j=1}^s a_{ij}$, therefore the coefficients $c_i$ are uniquely defined given the coefficients $a_{ij}$. Moreover, any non-autonomous system can be transformed in autonomous form via a straightforward transformation. 
\end{remark}
\noindent Runge-Kutta methods are completely defined by their coefficients $a_{ij}, b_i$. Therefore, these coefficients together with the evaluation points $c_i$, are usually organized graphically in a table called \textit{Butcher tableau}, i.e.,
\begin{center}
	\begin{tabular}{c|ccc}
		$c_1$ & $a_{11}$ & $\ldots$ & $a_{1s}$\\
		$\vdots$ & $\vdots$ & & $\vdots$ \\
		$c_s$ & $a_{s1}$ & $\ldots$ & $a_{ss}$\\
		\hline 
		&$b_1$ & $\ldots$ & $b_s$
	\end{tabular}
\end{center}
This graphical representation allows to present in a compact form the numerical method. The family of Runge-Kutta methods is divided in two subsets, explicit and implicit methods.
\begin{definition} A Runge-Kutta method is explicit if and only if $a_{ij} = 0$ for all $i \leq j \leq s$, otherwise it is implicit. 
\end{definition}
\noindent The main difference from an implementation point of view between explicit and implicit methods is that implicit methods require the solution of a nonlinear system of equations at each time step, while explicit methods are completely defined thanks to a recursive process. Therefore, implicit methods require a higher computational cost than explicit methods. On the other side, implicit methods are endowed with favorable properties which are not achievable by explicit methods. In this work, we will mainly use explicit methods, as Monte Carlo simulations will be required and the computational cost given by implicit methods would not be affordable. In particular, we will consider for our examples mainly three numerical schemes, the Explicit Euler (EE), the explicit midpoint (MP) and the classic Runge-Kutta (RK4) method, which are defined by the following Butcher tableaux \\ \\
\begin{minipage}{0.2\linewidth} 
	\begin{center}
		(EE)
		\begin{tabular}{c|c}
			$0$ & 0 \\
			\hline 
			&$1$ 
		\end{tabular}
	\end{center}
\end{minipage}
\begin{minipage}{0.3\linewidth} 
	\begin{center}
		(MP)
		\begin{tabular}{c|cc}
			0 & 0 & 0 \\
			1/2 & 1/2 & 0 \\
			\hline 
			& 0 & 1 
		\end{tabular}
	\end{center}
\end{minipage}
\begin{minipage}{0.5\linewidth} 
	\begin{center}
		(RK4)
		\begin{tabular}{c|cccc}
			$0$ & 0 & 0 & 0 & 0\\
			$1/2$ & 1/2 & 0 & 0 & 0\\
			$1/2$ & 0 & 1/2 & 0 & 0\\
			$1$ & 0 & 0 & 1 & 0\\
			\hline 
			&$1/6$ & 1/3 & 1/3 & 1/6
		\end{tabular}
	\end{center}
\end{minipage} \\ \\
As we can remark from their tableaux, these methods are all explicit, with one, two and four stages respectively.


One relevant property of Runge-Kutta methods in the frame of this work is the order of convergence, defined as follows. 
\begin{definition} Let us consider a sufficiently smooth differential equation \eqref{eq:ODE} and one step of the Runge-Kutta method defined in Definition \ref{def:RK}. If there exist $q > 0$ and a positive constant $C$ independent of $h$ such that 
\begin{equation}
	\abs{u(h)-U_1} \leq Ch^{q+1},
\end{equation}
then the method has local order $q$. 
\end{definition} 
\noindent It is possible to verify \cite{HLW02} that EE has local order 1, MP has local order 2 and RK4 has local order 4. 

The notation in \eqref{numericalODE} is derived from the notion of exact and numerical flow map of the differential equation \eqref{eq:ODE}. Let us consider the function $\Phi \colon \R^d \to \R^d$ such that the solution $u$ is given by
\begin{equation}
	u(t) = \Phi_t(u_0),
\end{equation}
i.e., the flow of the differential equation $\Phi$ maps the initial condition into the solution at time $t$. In the same way, we can write the solution at a time $t_2$ given the solution at time $t_1 < t_2$ as 
\begin{equation}
	u(t_2) = \Phi_{t_2 - t_1}(u(t_1)).
\end{equation}
The numerical solution given by a Runge-Kutta method can be as well written in terms of a flow map. If we consider a time step $h$ and the solution $U_k$ at the time step $t_k$, then we can write in a compact form the numerical solution at time $t_{k+1}$ as
\begin{equation}
	U_{k+1} = \Psi_h(U_k),
\end{equation}
where the function $\Psi\colon\R^d\to\R^d$ is the numerical flow map of the Runge-Kutta method. Let us remark that the function $\Psi$ is uniquely determined by the coefficients $a_{ij}, b_i$ introduced above.

The basic definitions and properties introduced above are sufficient for understanding the analysis of the probabilistic numerical method introduced in \eqref{eq:probMethod}. In the following, we will motivate the numerical method as well as study some of its features.

\documentclass[usenames,dvipsnames]{beamer}

\usetheme{Madrid}
\usecolortheme{dolphin}
\setbeamercolor{title}{fg=NavyBlue}
\setbeamercolor{frametitle}{fg=NavyBlue}
\setbeamercolor{section in toc}{fg=NavyBlue}

\usepackage{amsthm}
\usepackage{graphicx}
\usepackage[utf8x]{inputenc}
\usepackage{mathtools}
\mathtoolsset{showonlyrefs}
\usepackage{appendixnumberbeamer}
\usepackage{enumitem}
\usepackage{centernot}
\usepackage{tikz}
\usepackage[lined]{algorithm2e}
\usepackage{caption}
\usetikzlibrary{positioning}
\setitemize{label=-, leftmargin=*}
\usepackage{booktabs}
\usepackage{natbib}

\DeclarePairedDelimiter{\abs}{\lvert}{\rvert}
\DeclarePairedDelimiter{\norm}{\|}{\|}
\renewcommand{\Pr}{\mathbb{P}}
\newcommand{\R}{\mathbb{R}}
\newcommand{\Var}{\operatorname{Var}}
\newcommand{\E}{\operatorname{\mathbb{E}}}
\newcommand{\iid}{\ensuremath{\stackrel{\text{iid}}{\sim}}}
\renewcommand{\phi}{\varphi}
\newcommand{\epl}{\varepsilon}
\newcommand{\dd}{\,\mathrm{d}}

% Theorem blocks
\setbeamercolor{block title}{fg=white,bg=NavyBlue}
\newenvironment<>{greenblock}[1][]{%
\setbeamercolor{block title}{fg=white,bg=ForestGreen}%
\begin{block}#2{#1}}{\end{block}}
\newenvironment<>{redblock}[1][]{%
\setbeamercolor{block title}{fg=white,bg=red!75!black}%
\begin{block}#2{#1}}{\end{block}}
\newenvironment<>{orangeblock}[1][]{%
\setbeamercolor{block title}{fg=white,bg=orange!75!black}%
\begin{block}#2{#1}}{\end{block}}

% Add numbers and take out navigation symbols
\beamertemplatenavigationsymbolsempty
\setbeamercolor{date in head/foot}{fg=gray, bg=white}
\setbeamercolor{author in head/foot}{fg=white,bg=white}
\setbeamercolor{title in head/foot}{fg=white,bg=white}
\setbeamertemplate{footline}{
	\leavevmode%
	\hbox{%
		\begin{beamercolorbox}[wd=.4\paperwidth,ht=2.25ex,dp=1ex,center]{author in head/foot}%
		\end{beamercolorbox}%
		\begin{beamercolorbox}[wd=.3\paperwidth,ht=2.25ex,dp=1ex,center]{title in head/foot}%
		\end{beamercolorbox}%
		\begin{beamercolorbox}[wd=.3\paperwidth,ht=2.25ex,dp=1ex,right]{date in head/foot}%
			\insertframenumber{} / \inserttotalframenumber\hspace*{2ex} 
	\end{beamercolorbox}}%
	\vskip0pt%
}

\definecolor{leg1}{RGB}{0,114,189}
\definecolor{leg2}{RGB}{217,83,25}
\definecolor{leg3}{RGB}{237,177,32}
\definecolor{leg4}{RGB}{126,47,142}
\definecolor{leg5}{RGB}{119,172,48}


% Text starts always from the top of the frame
\newenvironment{frameT}{\begin{frame}[t]}{\end{frame}}

\newcommand*\samethanks[1][\value{footnote}]{\footnotemark[#1]}
\title{Bayesian inference of multiscale diffusion processes}
\author{Assyr Abdulle \thanks{Institute of Mathematics, EPFL} \and \underline{Giacomo Garegnani} \samethanks \and Grigoris Pavliotis \thanks{Department of Mathematics, Imperial College London}}
\date{Champ√©ry -- 11/13 June 2019}
\institute[EPFL]{MATHICSE Retreat \\ \vspace{0.5cm} \includegraphics[width=3cm]{Logo}}

\begin{document}

\thispagestyle{empty}
\frame{\titlepage}

\addtocounter{framenumber}{-1}

\begin{frame}
	\frametitle{Motivation}
	
	\begin{minipage}[t]{0.49\linewidth}	
	\begingroup \color{BrickRed}
	\begin{center} Bayesian inference \end{center}
		\begin{itemize}
			\item Fit model to data
			\item Full UQ approach 
		\end{itemize}
	\endgroup
	\end{minipage}
	\begin{minipage}[t]{0.49\linewidth}	
	\begingroup \color{NavyBlue}
	\begin{center} Diffusion processes \end{center}
	\begin{itemize}
		\item Intrinsically stochastic phenomena
		\item Analysis for BM noise
	\end{itemize}
	\endgroup
	\end{minipage}

	\vspace{1cm}
	\begin{center}
	\begin{minipage}[t]{0.49\linewidth}	
	\begingroup \color{ForestGreen}
	\begin{center} Multiscale \end{center}
	\begin{itemize}
		\item Numerous real-world applications
		\item Theory of homogenization applies
	\end{itemize}
	\endgroup
	\end{minipage}
	\end{center}

\end{frame}

\begin{frameT}
	\frametitle{Problem statement}
	
	\only<1-4> {
	Multiscale SDE -- first order Langevin
	\begin{equation*}
		\dd x^\epl(t) = - \begingroup \color{ForestGreen} \underbrace{\vphantom{\frac{1}{\epl} \nabla V_1\Big(\frac{x^\epl(t)}{\epl}\Big)} \alpha \nabla V_0\big(x^\epl(t)\big) \dd t}_{\text{large-scale potential}} \endgroup 
						- \begingroup \color{BrickRed}    \underbrace{\frac{1}{\epl} \nabla V_1\Big(\frac{x^\epl(t)}{\epl}\Big)}_{\text{fluctuating potential}} \dd t\endgroup 
						+ \begingroup \color{NavyBlue}    \underbrace{\vphantom{\frac{1}{\epl} \nabla V_1\Big(\frac{x^\epl(t)}{\epl}\Big)} \sqrt{2\sigma} \dd W(t)}_{\text{diffusion}} \endgroup.
	\end{equation*}
	}

	\only<2-4> {
	Homogenized SDE
	\begin{equation*}
		\dd x^0(t) = - \begingroup \color{ForestGreen} A \, \nabla V_0 (x^0(t)) \dd t \endgroup 
					 + \begingroup \color{NavyBlue} \sqrt{2 \Sigma} \dd W(t) \endgroup,  \quad A = K\alpha, \, \Sigma = K \sigma.
	\end{equation*}
	Homogenization result: $x^\epl \Rightarrow x^0$ in $\mathcal C^0\big((0, T), \R^d\big)$ for $\epl \to 0$.
	}

	\vspace{.05cm}
	\only<3> {
	\begin{center} \textbf{Inverse problem 1 -- MS / MS}
	
	\vspace{0.3cm}
	Find $\theta^\epl = (\alpha, \sigma)$ given $\mathbf y = \mathbf x^\epl(\theta^\epl) + \boldsymbol \eta$, $\boldsymbol \eta \sim \rho_\eta$.
	\end{center}
	Notation: $\R^{Nd}\ni\mathbf x^\epl = \big(x^\epl_1, x^\epl_2, \ldots, x^\epl_N\big)$, $x^\epl_k = x^\epl(t_k)$.
	}
	
	\only<4> {
	\begin{center} \textbf{Inverse problem 2 -- MS / HOM}
		
	\vspace{0.3cm}
	Find $\theta^0 = (A, \Sigma)$ given $\mathbf y = \mathbf x^\epl(\theta^\epl) + \boldsymbol \eta$, $\boldsymbol \eta \sim \rho_\eta$.
	\end{center}
	Notation: $\R^{Nd}\ni\mathbf x^\epl = \big(x^\epl_1, x^\epl_2, \ldots, x^\epl_N\big)$, $x^\epl_k = x^\epl(t_k)$.
	}
\end{frameT}

\begin{frameT}
	\frametitle{Bayesian framework}

	\only<1-6> {
	\begin{center} \textbf{Inverse problem 1 -- MS / MS}
		
		\vspace{0.3cm}
		Find $\theta^\epl = (\alpha, \sigma)^\top$ given $\mathbf y = \mathbf x^\epl(\theta^\epl) + \boldsymbol \eta$, $\boldsymbol \eta \sim \rho_\eta$.
	\end{center}
	}
	
	\only<1>{
	Posterior distribution $\mu^\epl(\theta^\epl \mid \mathbf y)$ with density
	\begin{equation}
		p^\epl(\theta^\epl \mid \mathbf y) = \frac{1}{Z^\epl} 
		\begingroup \color{ForestGreen} \underbrace{p(\theta^\epl)}_{\text{prior}} \endgroup \, 
		\begingroup \color{BrickRed} \underbrace{p^\epl(\mathbf y \mid \theta^\epl)}_{\text{likelihood}} \endgroup, 
		\quad Z^\epl \text{ s.t. } \int p^\epl(\theta \mid \mathbf y) \dd \theta = 1.
	\end{equation}
	
	{\color{ForestGreen} Prior}: Easy to evaluate (e.g. Gaussian), independent of $\epl$
	
	\vspace{0.3cm}
	{\color{BrickRed} Likelihood}: Needs more work
	}

	\only<2> {
	{\color{BrickRed} Likelihood}: Needs more work $\Rightarrow$ marginalization
	\begin{equation}
		{\color{BrickRed}	p^\epl(\mathbf y \mid \theta^\epl)} = \int_{\R^{Nd}} {\color{NavyBlue} p^\epl(\mathbf y \mid \mathbf x, \theta^\epl)} \, p^\epl(\mathbf x \mid \theta^\epl) \dd \mathbf x.
	\end{equation}
	where (observation independence)
	\begin{equation}
		{\color{NavyBlue} p^\epl(\mathbf y \mid \mathbf x, \theta^\epl) = \prod_{k=1}^N p^\epl(y_k \mid x_k, \theta^\epl)}.
	\end{equation}
	Observation density: $p(y_k \mid x_k, \theta^\epl) = \rho^{(k)}_\eta(y_k - x_k)$
	}

	\only<3> {
	{\color{BrickRed} Likelihood}: Needs more work $\Rightarrow$ marginalization
	\begin{equation}
	{\color{BrickRed}	p^\epl(\mathbf y \mid \theta^\epl)} = \int_{\R^{Nd}} {\color{NavyBlue} p(\mathbf y \mid \mathbf x, \theta^\epl)} \, p^\epl(\mathbf x \mid \theta^\epl) \dd \mathbf x.
	\end{equation}
	where (observation independence)
	\begin{equation}
	{\color{NavyBlue} p(\mathbf y \mid \mathbf x, \theta^\epl) = \prod_{k=1}^N p(y_k \mid x_k, \theta^\epl)}.
	\end{equation}
	Observation density: $p(y_k \mid x_k, \theta^\epl) = \rho^{(k)}_\eta(y_k - x_k)$ $\Rightarrow$ independent of $\epl$.
	}

	\only<4> {
	{\color{BrickRed} Likelihood}: Needs more work $\Rightarrow$ marginalization
	\begin{equation}
	{\color{BrickRed}	p^\epl(\mathbf y \mid \theta^\epl)} = \int_{\R^{Nd}} p(\mathbf y \mid \mathbf x, \theta^\epl) \, {\color{NavyBlue} p^\epl(\mathbf x \mid \theta^\epl)} \dd \mathbf x.
	\end{equation}
	where (Markov property)
	\begin{equation}
		{\color{NavyBlue} p^\epl(\mathbf x \mid \theta^\epl) = p(x_0) \prod_{k=1}^N p^\epl(x_k \mid x_{k-1}, \theta^\epl)}.
	\end{equation}
	\vphantom{Observation density: $p(y_k \mid x_k, \theta^\epl) = \rho^{(k)}_\eta(y_k - x_k)$ $\Rightarrow$ independent of $\epl$}Transition density: $p^\epl(x_k \mid x_{k-1}, \theta^\epl)$ $\Rightarrow$ only ``ingredient'' depending on $\epl$.
	}

	\only<5> {
	{\color{ForestGreen} Idea}: Replace  $p^0(\mathbf x \mid \theta^\epl) \approx p^\epl(\mathbf x \mid \theta^\epl)$ $\Rightarrow$ cheaper!
	
	\vspace{0.3cm}
	{\color{ForestGreen} Result}: Homogenized posterior $\mu^0(\theta \mid \mathbf y)$ with density  
	\begin{equation}
		p^0(\theta^\epl \mid \mathbf y) = \frac{1}{Z^0} 
		\begingroup \color{ForestGreen} p(\theta^\epl) \endgroup \, 
		\begingroup \color{BrickRed} p^0(\mathbf y \mid \theta^\epl) \endgroup, 
		\quad Z^0 \text{ s.t. } \int p^0(\theta \mid \mathbf y) \dd \theta = 1,
	\end{equation}
	with
	\begin{equation}
		{\color{BrickRed} p^0(\mathbf y \mid \theta^\epl)} = \int_{\R^{Nd}} p(\mathbf y \mid \mathbf x, \theta^\epl) \, p^0(\mathbf x \mid \theta^\epl) \dd \mathbf x.
	\end{equation}
	
	\vspace{0.2cm}
	{\color{BrickRed} High-dimensional integral} $\Rightarrow$ Compute unbiased estimator $\hat p^0(\mathbf y \mid \theta^\epl)$.
	}	

	\only<6>
	{
	{\color{ForestGreen} Idea}: Replace  $p^0(\mathbf x \mid \theta^\epl) \approx p^\epl(\mathbf x \mid \theta^\epl)$ $\Rightarrow$ cheaper!
	
	\vspace{0.3cm}
	{\color{ForestGreen} Result}: Homogenized posterior $\mu^0(\theta \mid \mathbf y)$ with density  
	\begin{equation}
	p^0(\theta^\epl \mid \mathbf y) = \frac{1}{Z^0} 
	\begingroup \color{ForestGreen} p(\theta^\epl) \endgroup \, 
	\begingroup \color{BrickRed} p^0(\mathbf y \mid \theta^\epl) \endgroup, 
	\quad Z^0 \text{ s.t. } \int p^0(\theta \mid \mathbf y) \dd \theta = 1,
	\end{equation}	
		
	\begin{block}{Proposition}
		Hellinger distance $d_{\mathrm{Hell}}\big(\mu^\epl(\cdot \mid \mathbf y), \mu^0(\cdot \mid \mathbf y)\big) \to 0$ for $\epl \to 0$.
	\end{block}	
	}
\end{frameT}

\appendix
\begin{frame}
\thispagestyle{empty}
\begin{center} \underline{Thank you for your attention!} \end{center}

\scriptsize{
\textbf{References}
\nocite{PaS07}
\nocite{GoW11}
\nocite{KKP15}
\nocite{PaS08}
}

\bibliographystyle{apalike}
\bibliography{../anmc}

\end{frame}

\end{document}

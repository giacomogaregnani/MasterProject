clc; clear; close all
addpath('resultsKL')
%%

s = 0.8;
b = 1;

alpha = dlmread('ResultsAlpha.txt');
hom = dlmread(['ResultsHom_s' num2str(s,'%.1f') '.txt']);
filter = dlmread(['ResultsFilter_s' num2str(s,'%.1f') '_b' num2str(b) '.txt']);
sub = dlmread(['ResultsSub_s' num2str(s,'%.1f') '.txt']);
noth = dlmread(['ResultsNot_s' num2str(s,'%.1f') '.txt']);

aHom = hom(1:end-1);
zetas = filter(:, end);
nParam = length(alpha);

drift = @(alpha, x) driftKL(x, alpha, nParam);
xTest = -1.3:0.01:1.3;

% figure
% plot(xTest, drift(alpha, xTest));
% hold on
% plot(xTest, drift(aHom, xTest));
% title('truth')

% for i = 1 : length(zetas)

W = 4; H = 4;

fig = createFigure(W, H, 'enhanced', 1);
plot(xTest, drift(alpha, xTest), 'k:');
hold on
plot(xTest, drift(aHom, xTest), 'k--');
plot(xTest, drift(filter(1, 1:end-1), xTest), 'k');
legend({'$\alpha \cdot V^\prime(x)$', '$A \cdot V^\prime(x)$', '$\hat A_{\mathrm{filt}} \cdot V^\prime(x)$'}, 'location', 'N', 'interpreter', 'latex')
export_fig(fig, ['~/Desktop/PaperSDE/Figures/KL_f' num2str(10*s) '.png'], '-painters', '-m5')


xlim([xTest(1), xTest(end)])

fig = createFigure(W, H, 'enhanced', 1);
plot(xTest, drift(alpha, xTest), 'k:');
hold on
plot(xTest, drift(aHom, xTest), 'k--');
plot(xTest, drift(sub(1, 1:end-1), xTest), 'k');
legend({'$\alpha \cdot V^\prime(x)$', '$A \cdot V^\prime(x)$', '$\hat A_{\mathrm{subs}} \cdot V^\prime(x)$'}, 'location', 'N', 'interpreter', 'latex')

xlim([xTest(1), xTest(end)])

fig = createFigure(W, H, 'enhanced', 1);
plot(xTest, drift(alpha, xTest), 'k:');
hold on
plot(xTest, drift(aHom, xTest), 'k--');
plot(xTest, drift(noth(1, :), xTest), 'k');
legend({'$\alpha \cdot V^\prime(x)$', '$A \cdot V^\prime(x)$', '$\hat A \cdot V^\prime(x)$'}, 'location', 'N', 'interpreter', 'latex')

xlim([xTest(1), xTest(end)])